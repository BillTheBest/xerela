package DataJUNOS3;

use strict;
use warnings;
use Exporter 'import';
our @EXPORT_OK = qw($responses);

our $responses;

$responses->{showFirewall} = <<'END';
show configuration firewall | display xml 
<rpc-reply xmlns:junos="http://xml.juniper.net/junos/8.5R2/junos">
     <configuration junos:commit-seconds="1219470431" junos:commit-localtime="2008-08-23 01:47:11 EDT" junos:commit-user="cmyers">
             <firewall>
                 <policer>
                     <name>LIMIT-500K</name>
                     <if-exceeding>
                         <bandwidth-limit>500k</bandwidth-limit>
                         <burst-size-limit>50k</burst-size-limit>
                     </if-exceeding>
                     <then>
                         <discard/>
                     </then>
                 </policer>
                 <policer>
                     <name>LIMIT-2M</name>
                     <if-exceeding>
                         <bandwidth-limit>2m</bandwidth-limit>
                         <burst-size-limit>500k</burst-size-limit>
                     </if-exceeding>
                     <then>
                         <discard/>
                     </then>
                 </policer>
                 <policer>
                     <name>LIMIT-5M</name>
                     <if-exceeding>
                         <bandwidth-limit>5m</bandwidth-limit>
                         <burst-size-limit>1m</burst-size-limit>
                     </if-exceeding>
                     <then>
                         <discard/>
                     </then>
                 </policer>
                 <policer>
                     <name>LIMIT-15M</name>
                     <if-exceeding>
                         <bandwidth-limit>15m</bandwidth-limit>
                         <burst-size-limit>1m</burst-size-limit>
                     </if-exceeding>
                     <then>
                         <discard/>
                     </then>
                 </policer>
                 <policer>
                     <name>LIMIT-100M</name>
                     <if-exceeding>
                         <bandwidth-limit>100m</bandwidth-limit>
                         <burst-size-limit>20m</burst-size-limit>
                     </if-exceeding>
                     <then>
                         <discard/>
                     </then>
                 </policer>
                 <policer>
                     <name>LIMIT-1M</name>
                     <if-exceeding>
                         <bandwidth-limit>1m</bandwidth-limit>
                         <burst-size-limit>250k</burst-size-limit>
                     </if-exceeding>
                     <then>
                         <discard/>
                     </then>
                 </policer>
                 <policer>
                     <name>LIMIT-50M</name>
                     <if-exceeding>
                         <bandwidth-limit>50m</bandwidth-limit>
                         <burst-size-limit>5m</burst-size-limit>
                     </if-exceeding>
                     <then>
                         <discard/>
                     </then>
                 </policer>
                 <family>
                     <inet>
                         <filter>
                             <name>RFC_src</name>
                             <junos:comment>/* discard anything with an RFC-1918 source address */</junos:comment>
                             <term>
                                 <name>RFC_src</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-RFC-1918</name>
                                     </source-prefix-list>
                                 </from>
                                 <then>
                                     <count>rfc_src</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>RFC_dest</name>
                             <junos:comment>/* discard anything with an RFC-1918 destination address */</junos:comment>
                             <term>
                                 <name>RFC_dest</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-RFC-1918</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <count>rfc_dst</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>OUTBOUND-INTERNET_SANITY</name>
                             <interface-specific/>
                             <junos:comment>/* No RFC destinations out to the internet */</junos:comment>
                             <term>
                                 <name>Check_dest</name>
                                 <filter>RFC_dest</filter>
                             </term>
                             <term>
                                 <name>Bad_ICMP</name>
                                 <filter>DENY-Bad_ICMP</filter>
                             </term>
                             <junos:comment>/* ICMP &amp; trace can go out from private, just won't get an answer */</junos:comment>
                             <term>
                                 <name>Diagnostics</name>
                                 <filter>Net_Diags</filter>
                             </term>
                             <junos:comment>/* OK, ICMP allowed.  Now no RFC sources. */</junos:comment>
                             <term>
                                 <name>Check_src</name>
                                 <filter>RFC_src</filter>
                             </term>
                             <junos:comment>/* Drop any protocol we don't expect */</junos:comment>
                             <term>
                                 <name>Check_protocol</name>
                                 <from>
                                     <prefix-list>
                                         <name>PL-ANY</name>
                                     </prefix-list>
                                     <junos:comment>/* No vrrp, pim, igmp, ospf needed on internet interface. */</junos:comment>
                                     <protocol-except>esp</protocol-except>
                                     <protocol-except>gre</protocol-except>
                                     <protocol-except>icmp</protocol-except>
                                     <protocol-except>tcp</protocol-except>
                                     <protocol-except>udp</protocol-except>
                                 </from>
                                 <then>
                                     <count>bad_proto</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>RE_comms</name>
                                 <junos:comment>/* Communication from the RE itself */</junos:comment>
                                 <from>
                                     <interface-group>3</interface-group>
                                 </from>
                                 <junos:comment>/* Allow the RE to talk.  Bad stuff blocked earlier. */</junos:comment>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>Final_allow</name>
                                 <junos:comment>/* Seems sane. Allow it out. */</junos:comment>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>INBOUND-INTERNET_SANITY</name>
                             <interface-specific/>
                             <junos:comment>/* Need to know who / why these are coming through. */</junos:comment>
                             <term>
                                 <name>Log_odd_protocols</name>
                                 <from>
                                     <protocol>rsvp</protocol>
                                     <protocol>sctp</protocol>
                                 </from>
                                 <then>
                                     <count>odd_proto</count>
                                     <syslog/>
                                 </then>
                             </term>
                             <junos:comment>/* Drop any protocol we don't expect */</junos:comment>
                             <term>
                                 <name>Check_protocol</name>
                                 <from>
                                     <prefix-list>
                                         <name>PL-ANY</name>
                                     </prefix-list>
                                     <junos:comment>/* No vrrp, pim, igmp, ospf needed on internet interface. */</junos:comment>
                                     <protocol-except>esp</protocol-except>
                                     <protocol-except>gre</protocol-except>
                                     <protocol-except>icmp</protocol-except>
                                     <protocol-except>tcp</protocol-except>
                                     <protocol-except>udp</protocol-except>
                                     <protocol-except>rsvp</protocol-except>
                                     <protocol-except>sctp</protocol-except>
                                 </from>
                                 <then>
                                     <count>bad_proto</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <junos:comment>/* No RFC destinations allowed in from the internet */</junos:comment>
                             <term>
                                 <name>Block_RFC_dest</name>
                                 <filter>RFC_dest</filter>
                             </term>
                             <junos:comment>/* Make sure the incoming destination address is something that we own */</junos:comment>
                             <term inactive="inactive">
                                 <name>Check_Dest</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-ATT_ATL-ALL</name>
                                         <except/>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-ICE_ARIN_SUMMARY</name>
                                         <except/>
                                     </destination-prefix-list>
                                     <junos:comment>/* Router interface blocks.  RFC's blocked earlier. */</junos:comment>
                                     <destination-prefix-list>
                                         <name>PL-LOCAL_ADDRESSES</name>
                                         <except/>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-ANY</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <count>bad_dst_ip</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Bad_ICMP</name>
                                 <filter>DENY-Bad_ICMP</filter>
                             </term>
                             <junos:comment>/* Destination is somewhat sane. ICMP &amp; trace allowed from any source */</junos:comment>
                             <term>
                                 <name>Diagnostics</name>
                                 <filter>Net_Diags</filter>
                             </term>
                             <junos:comment>/* Now block RFC sources */</junos:comment>
                             <term>
                                 <name>Check_src</name>
                                 <filter>RFC_src</filter>
                             </term>
                             <junos:comment>/* Block bad ports / scans */</junos:comment>
                             <term>
                                 <name>Check_TCP_Port</name>
                                 <filter>TCP_Check</filter>
                             </term>
                             <term>
                                 <name>Check_UDP_Port</name>
                                 <filter>UDP_Check</filter>
                             </term>
                             <term>
                                 <name>Final_allow</name>
                                 <junos:comment>/* Seems sane. Allow it in. */</junos:comment>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>TCP_Check</name>
                             <junos:comment>/* There are certain ports that should NEVER be targetted */</junos:comment>
                             <term>
                                 <name>Bad_TCP</name>
                                 <from>
                                     <protocol>tcp</protocol>
                                     <junos:comment>/* Netbios, MS SQL */</junos:comment>
                                     <destination-port>135</destination-port>
                                     <destination-port>137</destination-port>
                                     <destination-port>139</destination-port>
                                     <destination-port>445</destination-port>
                                     <destination-port>1433</destination-port>
                                     <destination-port>1434</destination-port>
                                 </from>
                                 <then>
                                     <count>bad_tcp_port</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>UDP_Check</name>
                             <junos:comment>/* There are certain ports that should NEVER be targetted */</junos:comment>
                             <term>
                                 <name>Bad_UDP</name>
                                 <from>
                                     <protocol>udp</protocol>
                                     <junos:comment>/* Netbios, MS SQL */</junos:comment>
                                     <destination-port>135</destination-port>
                                     <destination-port>137</destination-port>
                                     <destination-port>139</destination-port>
                                     <destination-port>445</destination-port>
                                     <destination-port>1433</destination-port>
                                     <destination-port>1434</destination-port>
                                 </from>
                                 <then>
                                     <count>bad_udp_port</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>SNMP_Check-Src</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-ICE_ADMIN</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-MONITORING</name>
                                     </source-prefix-list>
                                     <protocol>udp</protocol>
                                     <destination-port>161</destination-port>
                                     <destination-port>162</destination-port>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>SNMP_Check-Dest</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-MONITORING</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-UNFILTERED-ARIN</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-UNFILTERED-ATT</name>
                                     </destination-prefix-list>
                                     <protocol>udp</protocol>
                                     <destination-port>161</destination-port>
                                     <destination-port>162</destination-port>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>SNMP_Check-Deny</name>
                                 <from>
                                     <prefix-list>
                                         <name>PL-SNMP_CLIENTS</name>
                                         <except/>
                                     </prefix-list>
                                     <prefix-list>
                                         <name>PL-SNMP_TRAPS</name>
                                         <except/>
                                     </prefix-list>
                                     <prefix-list>
                                         <name>PL-ANY</name>
                                     </prefix-list>
                                     <protocol>udp</protocol>
                                     <destination-port>161</destination-port>
                                     <destination-port>162</destination-port>
                                 </from>
                                 <then>
                                     <count>bad_snmp</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                         </filter>
                         <junos:comment>/* Normal outbound filter for traffic heading to production */</junos:comment>
                         <filter>
                             <name>OUTBOUND-Prod_Normal</name>
                             <term>
                                 <name>UNFILTERED-Special_Src</name>
                                 <junos:comment>/* Unfiltered access for certain special source addresses */</junos:comment>
                                 <from>
                                     <junos:comment>/* Riveredge office */</junos:comment>
                                     <source-address>
                                         <name>66.20.217.4/32</name>
                                     </source-address>
                                     <source-address>
                                         <name>65.119.232.200/32</name>
                                     </source-address>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>UNFILTERED-Special_Dst</name>
                                 <junos:comment>/* Unfiltered access for certain special destination addresses, typically firewalls */</junos:comment>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-UNFILTERED-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-UNFILTERED-ARIN</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>UNFILTERED-Monitoring</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-MONITORING</name>
                                     </source-prefix-list>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>RE_comms</name>
                                 <from>
                                     <interface-group>3</interface-group>
                                 </from>
                                 <junos:comment>/* Allow the RE to talk.  Bad stuff blocked earlier. */</junos:comment>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>Multicast_protocols</name>
                                 <junos:comment>/* Just in case.  Should have been picked up by the Local_RE term. This is to monitor. */</junos:comment>
                                 <from>
                                     <junos:comment>/* Control protocols, not multicast data flow. */</junos:comment>
                                     <protocol>igmp</protocol>
                                     <protocol>pim</protocol>
                                 </from>
                                 <then>
                                     <count>mcast_ctl</count>
                                 <junos:comment>/* Allow &amp; count it.  If something shows up turn on syslog later. */</junos:comment>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>Local_RE_Networks</name>
                                 <junos:comment>/* Allow any communication to/from the direct-attached RE network */</junos:comment>
                                 <from>
                                     <prefix-list>
                                         <name>PL-LOCAL_ADDRESSES</name>
                                     </prefix-list>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>Multicast_MR-Block_all</name>
                                 <from>
                                     <destination-address>
                                         <name>63.247.112.116/30</name>
                                     </destination-address>
                                     <destination-address>
                                         <name>63.247.112.120/30</name>
                                     </destination-address>
                                     <destination-address>
                                         <name>63.247.112.124/30</name>
                                     </destination-address>
                                 </from>
                                 <then>
                                     <count>deny-mcast_mr</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>MarketMonitor-block_unknown_src</name>
                                 <junos:comment>/* Block all IP (tcp, udp, icmp, etc) from unknown hosts;  */</junos:comment>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-ICE_OFFICES</name>
                                         <except/>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-NonICE_MM_ALLOWED</name>
                                         <except/>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_OFFICES-NYBOT</name>
                                         <except/>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ANY</name>
                                     </source-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ORD</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <count>MM_unknown_src</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Bad_ICMP</name>
                                 <filter>DENY-Bad_ICMP</filter>
                             </term>
                             <junos:comment>/* ICMP, traceroute */</junos:comment>
                             <term>
                                 <name>Diagnostics</name>
                                 <filter>Net_Diags</filter>
                             </term>
                             <term>
                                 <name>MarketMonitor-filter_known-tcp</name>
                                 <junos:comment>/* Restrict to specific tcp ports; ICMP allowed by Diagnostics term */</junos:comment>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-ICE_OFFICES</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_OFFICES-NYBOT</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-NonICE_MM_ALLOWED</name>
                                     </source-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>tcp</protocol>
                                     <destination-port-except>80</destination-port-except>
                                     <destination-port-except>443</destination-port-except>
                                 </from>
                                 <then>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>MarketMonitor-filter_udp</name>
                                 <junos:comment>/* Block UDP to Market Monitor */</junos:comment>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-ICE_OFFICES</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_OFFICES-NYBOT</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-NonICE_MM_ALLOWED</name>
                                     </source-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>udp</protocol>
                                 </from>
                                 <then>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <junos:comment>/* Start with the more specific host rules. */</junos:comment>
                             <term>
                                 <name>MQ-tcp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-MQ_Servers-ATT</name>
                                     </destination-prefix-list>
                                     <protocol>tcp</protocol>
                                     <destination-port-except>1417</destination-port-except>
                                 </from>
                                 <then>
                                     <count>MQ_discard_tcp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>MQ-udp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-MQ_Servers-ATT</name>
                                     </destination-prefix-list>
                                     <protocol>udp</protocol>
                                 </from>
                                 <then>
                                     <count>MQ_discard_udp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <junos:comment>/* Now start on the groups */</junos:comment>
                             <term>
                                 <name>WebICE-tcp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>tcp</protocol>
                                     <destination-port-except>80</destination-port-except>
                                     <destination-port-except>443</destination-port-except>
                                 </from>
                                 <then>
                                     <count>WebICE_discard_tcp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>WebICE-udp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>udp</protocol>
                                 </from>
                                 <then>
                                     <count>WebICE_discard_udp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>FIX-tcp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>tcp</protocol>
                                     <destination-port-except>80</destination-port-except>
                                     <destination-port-except>443</destination-port-except>
                                 </from>
                                 <then>
                                     <count>FIX_discard_tcp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>FIX-udp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>udp</protocol>
                                 </from>
                                 <then>
                                     <count>FIX_discard_udp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>FIX_Getco-tcp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-FIX_Getco</name>
                                     </destination-prefix-list>
                                     <protocol>tcp</protocol>
                                     <junos:comment>/* Really 81/82, including 80/443 as precautionary measure */</junos:comment>
                                     <destination-port-except>80</destination-port-except>
                                     <destination-port-except>81</destination-port-except>
                                     <destination-port-except>82</destination-port-except>
                                     <destination-port-except>443</destination-port-except>
                                 </from>
                                 <then>
                                     <count>FIX_G_discard_tcp</count>
                                 </then>
                             </term>
                             <term>
                                 <name>FIX_Getco-udp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-FIX_Getco</name>
                                     </destination-prefix-list>
                                     <protocol>udp</protocol>
                                 </from>
                                 <then>
                                     <count>FIX_G_discard_udp</count>
                                 </then>
                             </term>
                             <term>
                                 <name>TT-tcp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-TT-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>tcp</protocol>
                                     <destination-port-except>80</destination-port-except>
                                     <destination-port-except>443</destination-port-except>
                                 </from>
                                 <then>
                                     <count>TT_discard_tcp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>TT-udp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-TT-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>udp</protocol>
                                 </from>
                                 <then>
                                     <count>TT_discard_udp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Pricefeed-tcp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>tcp</protocol>
                                     <destination-port-except>80</destination-port-except>
                                     <destination-port-except>443</destination-port-except>
                                 </from>
                                 <then>
                                     <count>PF_discard_tcp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Pricefeed-udp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>udp</protocol>
                                 </from>
                                 <then>
                                     <count>PF_discard_udp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>API-tcp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-API-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>tcp</protocol>
                                     <destination-port-except>80</destination-port-except>
                                     <destination-port-except>443</destination-port-except>
                                     <destination-port-except>8080</destination-port-except>
                                 </from>
                                 <then>
                                     <count>API_discard_tcp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>API-udp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-API-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-ORD</name>
                                     </destination-prefix-list>
                                     <protocol>udp</protocol>
                                 </from>
                                 <then>
                                     <count>API_discard_udp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Block_Clear_Internet</name>
                                 <junos:comment>/* Block clear text stuff that shouldn't be allowed from internet */</junos:comment>
                                 <from>
                                     <junos:comment>/* Internet interfaces */</junos:comment>
                                     <interface-group>1</interface-group>
                                     <junos:comment>/* FIX groups */</junos:comment>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ORD</name>
                                     </destination-prefix-list>
                                     <junos:comment>/* API groups */</junos:comment>
                                     <destination-prefix-list>
                                         <name>PL-API-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-ORD</name>
                                     </destination-prefix-list>
                                     <junos:comment>/* TT groups */</junos:comment>
                                     <destination-prefix-list>
                                         <name>PL-TT-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-ORD</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ORD</name>
                                     </destination-prefix-list>
                                     <junos:comment>/* TCP 80 */</junos:comment>
                                     <protocol>tcp</protocol>
                                     <destination-port>80</destination-port>
                                 </from>
                                 <then>
                                     <count>discard_inet_clear</count>
                                     <syslog inactive="inactive"/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Block_Bad_UDP</name>
                             <junos:comment>/* Filter out any known bad UDP ports */</junos:comment>
                                 <filter>UDP_Check</filter>
                             </term>
                             <term>
                                 <name>UDP_services</name>
                                 <junos:comment>/* List all expected UDP ports (snmp, syslog, ntp, ike, dns, ???). */</junos:comment>
                                 <from>
                                     <protocol>udp</protocol>
                                     <source-port-except>domain</source-port-except>
                                     <source-port-except>ntp</source-port-except>
                                     <source-port-except>snmp</source-port-except>
                                     <source-port-except>snmptrap</source-port-except>
                                     <source-port-except>500</source-port-except>
                                     <source-port-except>syslog</source-port-except>
                                     <destination-port-except>domain</destination-port-except>
                                     <destination-port-except>ntp</destination-port-except>
                                     <destination-port-except>snmp</destination-port-except>
                                     <destination-port-except>snmptrap</destination-port-except>
                                     <destination-port-except>500</destination-port-except>
                                     <destination-port-except>syslog</destination-port-except>
                                 </from>
                                 <then>
                                     <count>udp_svcs-bad</count>
                                     <syslog/>
                                     <next>term</next>
                                 </then>
                             </term>
                             <term inactive="inactive">
                                 <name>UDP_services-dst</name>
                                 <junos:comment>/* List all expected UDP ports (snmp, syslog, ntp, ike, dns, ???). */</junos:comment>
                                 <from>
                                     <protocol>udp</protocol>
                                     <destination-port>domain</destination-port>
                                     <destination-port>ntp</destination-port>
                                     <destination-port>snmp</destination-port>
                                     <destination-port>snmptrap</destination-port>
                                     <destination-port>500</destination-port>
                                     <destination-port>syslog</destination-port>
                                 </from>
                                 <then>
                                     <next>term</next>
                                 </then>
                             </term>
                             <term inactive="inactive">
                                 <name>UDP_services-src</name>
                                 <junos:comment>/* List all expected UDP ports (snmp, syslog, ntp, ike, dns, ???). */</junos:comment>
                                 <from>
                                     <protocol>udp</protocol>
                                     <source-port>domain</source-port>
                                     <source-port>ntp</source-port>
                                     <source-port>snmp</source-port>
                                     <source-port>snmptrap</source-port>
                                     <source-port>500</source-port>
                                     <source-port>syslog</source-port>
                                 </from>
                                 <then>
                                     <next>term</next>
                                 </then>
                             </term>
                             <term inactive="inactive">
                                 <name>UDP_services-Other</name>
                                 <junos:comment>/* Known UDP should have already been accepted. Discard anything else. */</junos:comment>
                                 <from>
                                     <protocol>udp</protocol>
                                 </from>
                                 <then>
                                     <count>udp_other</count>
                                     <syslog/>
                                     <next>term</next>
                                 </then>
                             </term>
                             <junos:comment>/* FW'd blocks.  Allow rsvp, sctp &amp; log */</junos:comment>
                             <term>
                                 <name>Web_Services-Firewall-rsvp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-ORD</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-ATT</name>
                                     </destination-prefix-list>
                                     <protocol>rsvp</protocol>
                                 </from>
                                 <then>
                                     <count>proto-rsvp</count>
                                     <syslog/>
                                     <next>term</next>
                                 </then>
                             </term>
                             <term>
                                 <name>Web_Services-Firewall-sctp</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-ORD</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-ATT</name>
                                     </destination-prefix-list>
                                     <protocol>sctp</protocol>
                                 </from>
                                 <then>
                                     <count>proto-sctp</count>
                                     <syslog/>
                                     <next>term</next>
                                 </then>
                             </term>
                             <junos:comment>/* These nets go through the firewall. Block non-tcp/udp, let the firewall deal with those. */</junos:comment>
                             <term>
                                 <name>Web_Services-Firewall</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-ORD</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WEB_SVCS-ATT</name>
                                     </destination-prefix-list>
                                     <protocol-except>tcp</protocol-except>
                                     <protocol-except>udp</protocol-except>
                                 </from>
                                 <then>
                                     <count>bad_web_proto</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <junos:comment>/* Made it through the outside filter(s) &amp; through the above discards. Let it through. */</junos:comment>
                             <term inactive="inactive">
                                 <name>Final_Accept</name>
                                 <then>
                                     <next>term</next>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>FW-ACCEPT</name>
                             <junos:comment>/* Use this in a firewall chain to accept data */</junos:comment>
                             <term>
                                 <name>Default</name>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>FW-DENY</name>
                             <junos:comment>/* Use this in a firewall chain to deny data */</junos:comment>
                             <term>
                                 <name>Default</name>
                                 <then>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>DENY-Bad_ICMP</name>
                             <junos:comment>/* Use this filter wherever ICMP is checked to get rid of bad stuff first. */</junos:comment>
                             <term>
                                 <name>Bad_ICMP</name>
                                 <junos:comment>/* Only the listed types are valid.  All others get dropped. */</junos:comment>
                                 <from>
                                     <protocol>icmp</protocol>
                                     <icmp-type-except>echo-reply</icmp-type-except>
                                     <icmp-type-except>echo-request</icmp-type-except>
                                     <icmp-type-except>parameter-problem</icmp-type-except>
                                     <icmp-type-except>time-exceeded</icmp-type-except>
                                     <icmp-type-except>timestamp</icmp-type-except>
                                     <icmp-type-except>timestamp-reply</icmp-type-except>
                                     <icmp-type-except>unreachable</icmp-type-except>
                                 </from>
                                 <then>
                                     <count>bad_icmp</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>Net_Diags</name>
                             <term>
                                 <name>Good_ICMP</name>
                                 <junos:comment>/* Bad was dropped above, now allow ICMP through */</junos:comment>
                                 <from>
                                     <protocol>icmp</protocol>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>traceroute</name>
                                 <junos:comment>/* UDP range for traceroute */</junos:comment>
                                 <from>
                                     <protocol>udp</protocol>
                                     <destination-port>33434-33525</destination-port>
                                 </from>
                                 <junos:comment>/* Allow here.  We'll block other udp later. */</junos:comment>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>PROTECT-RE</name>
                             <term>
                                 <name>DENY-HSRP</name>
                                 <from>
                                     <destination-address>
                                         <name>224.0.0.2/32</name>
                                     </destination-address>
                                     <protocol>udp</protocol>
                                     <port>1985</port>
                                 </from>
                                 <then>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>DENY-BOOTP</name>
                                 <from>
                                     <protocol>udp</protocol>
                                     <protocol>tcp</protocol>
                                     <port>67</port>
                                     <port>68</port>
                                 </from>
                                 <then>
                                     <count>discard_bootp</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>DENY-BAD_ICMP</name>
                                 <filter>DENY-Bad_ICMP</filter>
                             </term>
                             <term>
                                 <name>DENY-BAD_TCP</name>
                             <junos:comment>/* Netbios, sql */</junos:comment>
                                 <filter>TCP_Check</filter>
                             </term>
                             <term>
                                 <name>DENY-BAD_UDP</name>
                             <junos:comment>/* Netbios, sql */</junos:comment>
                                 <filter>UDP_Check</filter>
                             </term>
                             <term>
                                 <name>DENY-SRC_ROUTE</name>
                                 <from>
                                     <ip-options> strict-source-route | loose-source-route </ip-options>
                                 </from>
                                 <then>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>LIMIT-SYN-FIN</name>
                                 <from>
                                     <protocol>tcp</protocol>
                                     <tcp-flags> syn &amp; fin </tcp-flags>
                                 </from>
                                 <then>
                                     <policer>LIMIT-500K</policer>
                                     <count>syn+fin</count>
                                     <syslog/>
                                     <next>term</next>
                                 </then>
                             </term>
                             <term>
                                 <name>BFD</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-LOCAL_ADDRESSES</name>
                                     </source-prefix-list>
                                     <protocol>udp</protocol>
                                     <destination-port>3784</destination-port>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <junos:comment>/* This is here instead of Net_Diag so it can be policed. */</junos:comment>
                             <term>
                                 <name>Diag-ICMP</name>
                                 <from>
                                     <protocol>icmp</protocol>
                                 </from>
                                 <then>
                                     <policer>LIMIT-1M</policer>
                                     <accept/>
                                 </then>
                             </term>
                             <junos:comment>/* This is here instead of Net_Diag so it can be policed. */</junos:comment>
                             <term>
                                 <name>Diag-TRACEROUTE</name>
                                 <from>
                                     <protocol>udp</protocol>
                                     <port>33434-33689</port>
                                 </from>
                                 <then>
                                     <policer>LIMIT-500K</policer>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>Routing-BGP</name>
                                 <from>
                                     <prefix-list>
                                         <name>PL-BGP_PEERS</name>
                                     </prefix-list>
                                     <protocol>tcp</protocol>
                                     <port>bgp</port>
                                 </from>
                                 <then>
                                     <policer>LIMIT-100M</policer>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>Routing-OSPF</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-LOCAL_ADDRESSES</name>
                                     </source-prefix-list>
                                     <protocol>ospf</protocol>
                                 </from>
                                 <then>
                                     <policer>LIMIT-15M</policer>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>NTP-ICE</name>
                                 <junos:comment>/* This puts ICE queries in a different policer group */</junos:comment>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-NTP_PEERS</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-NTP_SERVERS</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-LOCAL_ADDRESSES</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_ROUTERS-PRV</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_OFFICES</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_ARIN_SUMMARY</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ATT_ATL-ALL</name>
                                     </source-prefix-list>
                                     <protocol>udp</protocol>
                                     <port>ntp</port>
                                 </from>
                                 <then>
                                     <policer>LIMIT-1M</policer>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>NTP-OTHERS</name>
                                 <junos:comment>/* All non-ICE ntp queries */</junos:comment>
                                 <from>
                                     <protocol>udp</protocol>
                                     <port>ntp</port>
                                 </from>
                                 <then>
                                     <policer>LIMIT-500K</policer>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>SSH-ACCEPT-LOG_START</name>
                                 <junos:comment>/* This is here to help maintain an audit trail of valid ssh connections */</junos:comment>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-ICE_ADMIN</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-SSH_GUESTS</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_ROUTERS-PRV</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_ARIN_SUMMARY</name>
                                     </source-prefix-list>
                                     <protocol>tcp</protocol>
                                     <port>ssh</port>
                                     <tcp-initial/>
                                 </from>
                                 <then>
                                     <syslog/>
                                     <next>term</next>
                                 </then>
                             </term>
                             <term>
                                 <name>SSH-ACCEPT</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-ICE_ADMIN</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-SSH_GUESTS</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_ROUTERS-PRV</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_ARIN_SUMMARY</name>
                                     </source-prefix-list>
                                     <protocol>tcp</protocol>
                                     <port>ssh</port>
                                 </from>
                                 <then>
                                     <policer>LIMIT-50M</policer>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>SSH-REJECT</name>
                                 <from>
                                     <protocol>tcp</protocol>
                                     <port>ssh</port>
                                 </from>
                                 <then>
                                     <count>discard_ssh</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>GRE</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-GRE_PEERS</name>
                                     </source-prefix-list>
                                     <protocol>gre</protocol>
                                 </from>
                                 <then>
                                     <count>gre-count</count>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>IKE</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-IPSEC_PEERS</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-GRE_PEERS</name>
                                     </source-prefix-list>
                                     <protocol>udp</protocol>
                                     <port>500</port>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>IPSEC</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-IPSEC_PEERS</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-GRE_PEERS</name>
                                     </source-prefix-list>
                                     <protocol>50</protocol>
                                 </from>
                                 <then>
                                     <count>ipsec-count</count>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>Multicast-PIM</name>
                                 <from>
                                     <interface-group-except>1</interface-group-except>
                                     <protocol>pim</protocol>
                                 </from>
                                 <then>
                                     <policer>LIMIT-500K</policer>
                                     <count>pim-count</count>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>Multicast-IGMP</name>
                                 <from>
                                     <interface-group-except>1</interface-group-except>
                                     <protocol>igmp</protocol>
                                 </from>
                                 <then>
                                     <policer>LIMIT-500K</policer>
                                     <count>igmp-count</count>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>Multicast-MSDP</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-MSDP_PEERS</name>
                                     </source-prefix-list>
                                     <protocol>tcp</protocol>
                                     <port>639</port>
                                 </from>
                                 <then>
                                     <policer>LIMIT-2M</policer>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>SNMP</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-SNMP_CLIENTS</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-SNMP_TRAPS</name>
                                     </source-prefix-list>
                                     <protocol>udp</protocol>
                                     <port>snmp</port>
                                 </from>
                                 <then>
                                     <policer>LIMIT-2M</policer>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>SNMP-DenyLog</name>
                                 <from>
                                     <protocol>udp</protocol>
                                     <port>snmp</port>
                                 </from>
                                 <then>
                                     <count>SNMP_deny</count>
                                     <syslog/>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>DNS</name>
                                 <junos:comment>/* No DNS servers peresently set but leave this in place. */</junos:comment>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-DNS_SERVERS</name>
                                     </source-prefix-list>
                                     <protocol>tcp</protocol>
                                     <protocol>udp</protocol>
                                     <port>domain</port>
                                 </from>
                                 <then>
                                     <policer>LIMIT-500K</policer>
                                     <count>dns-count</count>
                                     <accept/>
                                 </then>
                             </term>
                             <term inactive="inactive">
                                 <name>VRRP</name>
                                 <junos:comment>/* No VRRP yet. Leave in but deactivated. */</junos:comment>
                                 <from>
                                     <destination-address>
                                         <name>224.0.0.18/32</name>
                                     </destination-address>
                                     <protocol>112</protocol>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term inactive="inactive">
                                 <name>LOCAL</name>
                                 <junos:comment>/* This probably isn't necessary.  Counting to see if it gets hit. */</junos:comment>
                                 <from>
                                     <source-address>
                                         <name>127.0.0.1/32</name>
                                     </source-address>
                                     <source-prefix-list>
                                         <name>PL-LOCAL_ADDRESSES</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_ROUTERS-PRV</name>
                                     </source-prefix-list>
                                 </from>
                                 <then>
                                     <policer>LIMIT-50M</policer>
                                     <count>local_term</count>
                                     <log/>
                                     <accept/>
                                 </then>
                             </term>
                             <term inactive="inactive">
                                 <name>TCP-ESTABLISHED</name>
                                 <junos:comment>/* This shouldn't really get hit due to the above rules but it may.  Counting to see. */</junos:comment>
                                 <from>
                                     <tcp-established/>
                                 </from>
                                 <then>
                                     <count>tcp_established</count>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>SUPPORT</name>
                                 <from>
                                     <address>
                                         <name>207.17.137.34/32</name>
                                     </address>
                                 </from>
                                 <then>
                                     <count>support</count>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>DENY-ALL</name>
                                 <then>
                                     <count>discard_all</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                         </filter>
                         <junos:comment>/* What to block when in maintenance mode */</junos:comment>
                         <filter>
                             <name>OUTBOUND-MAINT</name>
                             <interface-specific inactive="inactive"/>
                             <junos:comment>/* List of safe sources.  Typically ICE offices. */</junos:comment>
                             <term>
                                 <name>Safe_Sources</name>
                                 <from>
                                     <source-address>
                                         <name>66.20.217.4/32</name>
                                     </source-address>
                                     <source-address>
                                         <name>12.129.103.0/24</name>
                                     </source-address>
                                     <source-prefix-list>
                                         <name>PL-ICE_OFFICES</name>
                                     </source-prefix-list>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>Block_MM</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-MarketMonitor-ORD</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <count>maint-mkt_mon</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Block_MQ</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-MQ_Servers-ATT</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <count>maint-mq</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Block_WebICE</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-WebICE-ORD</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <count>maint-webice</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Block_Fix</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX-ORD</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-FIX_Getco</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <count>maint-fix</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Block_API</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-API-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-API-ORD</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <count>maint-api</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Block_TT</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-TT-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-TT-ORD</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <count>maint-tt</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                             <term>
                                 <name>Block_Pricefeed</name>
                                 <from>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ATT</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-Prod</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ATL</name>
                                     </destination-prefix-list>
                                     <destination-prefix-list>
                                         <name>PL-Pricefeed-ORD</name>
                                     </destination-prefix-list>
                                 </from>
                                 <then>
                                     <count>maint-pricefeed</count>
                                     <discard>
                                     </discard>
                                 </then>
                             </term>
                         </filter>
                         <filter>
                             <name>PROTECT_ICEBREAKER</name>
                             <term>
                                 <name>Allow_src</name>
                                 <from>
                                     <source-prefix-list>
                                         <name>PL-ICE_ARIN_SUMMARY</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_ADMIN</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ATT_ATL_PROD</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ATT_ATL_STAGING</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_OFFICES-NYBOT</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_OFFICES</name>
                                     </source-prefix-list>
                                     <source-prefix-list>
                                         <name>PL-ICE_TRANSPORT</name>
                                     </source-prefix-list>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                             <term>
                                 <name>PTMS_Testing</name>
                                 <from>
                                     <source-address>
                                         <name>65.215.59.185/32</name>
                                     </source-address>
                                     <protocol>tcp</protocol>
                                     <source-port>443</source-port>
                                 </from>
                                 <then>
                                     <accept/>
                                 </then>
                             </term>
                         </filter>
                         <service-filter>
                             <name>IPSEC_FILTER-IN</name>
                             <term>
                                 <name>ORD-02</name>
                                 <from>
                                     <source-address>
                                         <name>65.113.85.222/32</name>
                                     </source-address>
                                     <destination-address>
                                         <name>12.129.115.230/32</name>
                                     </destination-address>
                                     <protocol>esp</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_IN-ord-m320-02</count>
                                     <service/>
                                 </then>
                             </term>
                             <term>
                                 <name>LHUB-01</name>
                                 <from>
                                     <source-address>
                                         <name>195.33.25.65/32</name>
                                     </source-address>
                                     <destination-address>
                                         <name>12.129.115.230/32</name>
                                     </destination-address>
                                     <protocol>esp</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_IN-lhub-m120-01</count>
                                     <service/>
                                 </then>
                             </term>
                             <term>
                                 <name>ngx_web01b</name>
                                 <from>
                                     <source-address>
                                         <name>207.54.113.250/32</name>
                                     </source-address>
                                     <destination-address>
                                         <name>12.129.115.230/32</name>
                                     </destination-address>
                                     <protocol>esp</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_IN-ngx_web01b</count>
                                     <service/>
                                 </then>
                             </term>
                             <term inactive="inactive">
                                 <name>NYHub1-02</name>
                                 <from>
                                     <source-address>
                                         <name>149.17.195.65/32</name>
                                     </source-address>
                                     <destination-address>
                                         <name>12.129.115.230/32</name>
                                     </destination-address>
                                     <protocol>esp</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_IN-nyhub1-02</count>
                                     <service/>
                                 </then>
                             </term>
                             <term>
                                 <name>NY2HUB-02</name>
                                 <from>
                                     <source-address>
                                         <name>67.134.238.68/32</name>
                                     </source-address>
                                     <destination-address>
                                         <name>12.129.115.230/32</name>
                                     </destination-address>
                                     <protocol>esp</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_IN-ny2hub-m120-02</count>
                                     <service/>
                                 </then>
                             </term>
                             <term>
                                 <name>Other</name>
                                 <from>
                                     <destination-address>
                                         <name>12.129.115.230/32</name>
                                     </destination-address>
                                     <source-prefix-list>
                                         <name>PL-IPSEC_PEERS</name>
                                     </source-prefix-list>
                                     <protocol>esp</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_IN-Others</count>
                                     <service/>
                                 </then>
                             </term>
                             <term>
                                 <name>default</name>
                                 <then>
                                     <skip/>
                                 </then>
                             </term>
                         </service-filter>
                         <service-filter>
                             <name>IPSEC_FILTER-OUT</name>
                             <term>
                                 <name>ORD-02</name>
                                 <from>
                                     <source-address>
                                         <name>12.129.115.230/32</name>
                                     </source-address>
                                     <destination-address>
                                         <name>65.113.85.222/32</name>
                                     </destination-address>
                                     <protocol>gre</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_OUT-ord_m320_02</count>
                                     <service/>
                                 </then>
                             </term>
                             <term>
                                 <name>LHUB-01</name>
                                 <from>
                                     <source-address>
                                         <name>12.129.115.230/32</name>
                                     </source-address>
                                     <destination-address>
                                         <name>195.33.25.65/32</name>
                                     </destination-address>
                                     <protocol>gre</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_OUT-lhub-m120-01</count>
                                     <service/>
                                 </then>
                             </term>
                             <term>
                                 <name>ngx_web01b</name>
                                 <from>
                                     <source-address>
                                         <name>12.129.115.230/32</name>
                                     </source-address>
                                     <destination-address>
                                         <name>207.54.113.250/32</name>
                                     </destination-address>
                                     <protocol>gre</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_OUT-ngx_web01b</count>
                                     <service/>
                                 </then>
                             </term>
                             <term inactive="inactive">
                                 <name>NYHub1-02</name>
                                 <from>
                                     <source-address>
                                         <name>12.129.115.230/32</name>
                                     </source-address>
                                     <destination-address>
                                         <name>149.17.195.65/32</name>
                                     </destination-address>
                                     <protocol>gre</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_OUT-nyhub1-02</count>
                                     <service/>
                                 </then>
                             </term>
                             <term>
                                 <name>NY2HUB-02</name>
                                 <from>
                                     <source-address>
                                         <name>12.129.115.230/32</name>
                                     </source-address>
                                     <destination-address>
                                         <name>67.134.238.68/32</name>
                                     </destination-address>
                                     <protocol>gre</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_OUT-ny2hub-m120-02</count>
                                     <service/>
                                 </then>
                             </term>
                             <term>
                                 <name>Other</name>
                                 <from>
                                     <source-address>
                                         <name>12.129.115.230/32</name>
                                     </source-address>
                                     <destination-prefix-list>
                                         <name>PL-IPSEC_PEERS</name>
                                     </destination-prefix-list>
                                     <protocol>gre</protocol>
                                 </from>
                                 <then>
                                     <count>ESP_OUT-Others</count>
                                     <service/>
                                 </then>
                             </term>
                             <term>
                                 <name>default</name>
                                 <then>
                                     <skip/>
                                 </then>
                             </term>
                         </service-filter>
                     </inet>
                 </family>
             </firewall>
     </configuration>
     <cli>
         <banner>{master}</banner>
     </cli>
</rpc-reply>
 
{master}
cmyers@atl-ext-m320-02> 
END
